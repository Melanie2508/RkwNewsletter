{namespace rkwMailer=RKW\RkwMailer\ViewHelpers}
{namespace rkwBasics=RKW\RkwBasics\ViewHelpers}
{namespace rkwNewsletter=RKW\RkwNewsletter\ViewHelpers}

<!-- PLAINTEXT -->
<f:section name="Plaintext"><f:if condition="{pages}"><f:for each="{pages}" as="page"><f:for each="<rkwNewsletter:getNewsletterContents issue='{issue}' page='{page}' includeEditorials='{includeEditorials}' />" as="content" iteration="itemIterator"><f:if condition="{iterator.cycle} < {maxItemsPerTopic}"><f:then><f:render partial="Default/Items/Default" section="Plaintext" arguments="{_all}" /></f:then><f:else><f:if condition="{itemIterator.isLast}"><f:render partial="Default/Items/More" section="Plaintext" arguments="{_all}" /></f:if>
</f:else></f:if></f:for></f:for></f:if></f:section>


<!-- HTML -->
<f:section name="Html">

    <f:if condition="{pages}">

        <f:for each="{pages}" as="page" iteration="pageIterator">

            <f:for each="<rkwNewsletter:getNewsletterContents issue='{issue}' page='{page}' includeEditorials='{includeEditorials}' />" as="content" iteration="itemIterator">

                <f:if condition="{content.txRkwnewsletterIsEditorial}">
                    <f:then>

                        <!-- editorial -->
                        <f:render partial="Default/Items/Editorial" section="Html" arguments="{_all}" />

                    </f:then>

                    <f:else>

                        <f:if condition="{itemIterator.cycle} < {maxItemsPerTopic}">
                            <f:then>

                                <!-- normal -->
                                <f:render partial="Default/Items/Default" section="Html" arguments="{_all}" />

                            </f:then>
                            <f:else>
                                <f:if condition="{itemIterator.isLast}">

                                    <!-- more link -->
                                    <tr>
                                        <td style="padding: 16px 16px 0">
                                            <f:render partial="Default/Items/More" section="Html" arguments="{_all}" />
                                        </td>
                                    </tr>
                                </f:if>
                            </f:else>
                        </f:if>
                    </f:else>
                </f:if>
            </f:for>
        </f:for>
    </f:if>

</f:section>